Starting Container
npm warn config production Use `--omit=dev` instead.

> bot-data-service@1.0.0 prestart
> npx prisma generate --schema ../prisma/schema.prisma

npm warn config production Use `--omit=dev` instead.
Prisma schema loaded from ../prisma/schema.prisma

âœ” Generated Prisma Client (v6.14.0) to ./node_modules/.prisma/client in 272ms

Start by importing your Prisma Client (See: https://pris.ly/d/importing-client)

Tip: Interested in query caching in just a few lines of code? Try Accelerate today! https://pris.ly/tip-3-accelerate


> bot-data-service@1.0.0 start
> node dist/main.js

INFO: Prometheus metrics collection enabled
INFO: Connected to Redis successfully
INFO: Redis client ready for operations
INFO: Connected to PostgreSQL (data-sync)
INFO: Redis health check passed
INFO: ðŸ”„ Using cached Beds24 refresh token from Redis
INFO: âœ… Beds24 write token loaded from cache {"tokenLength":172,"source":"redis-cache"}
INFO: âœ… Beds24 client initialized successfully
INFO: [data-sync] listening on :8080
INFO: Beds24 webhook received bookingId=73842286 action=MODIFY {"type":"beds24:webhook","bookingId":73842286,"action":"MODIFY","payload":{"timeStamp":"2025-08-16T03:28:17Z","booking":{"id":73842286,"masterId":null,"bookingGroup":null,"propertyId":240061,"roomId":506591,"unitId":1,"roomQty":1,"offerId":1,"status":"confirmed","subStatus":"none","arrival":"2025-08-26","departure":"2025-09-02","numAdult":2,"numChild":0,"title":"STIVEN COLEGA","firstName":"","lastName":"","email":"","phone":"","mobile":"","fax":"","company":"","address":"","city":"","state":"","postcode":"","country":"","country2":null,"arrivalTime":"","voucher":"","comments":"","notes":"Transferred from Aparta Estudio 1722-B para Apartamento 715 at 22:28 - 15 Aug 2025\n","message":"","groupNote":"","custom1":"","custom2":"","custom3":"","custom4":"","custom5":"","custom6":"","custom7":"","custom8":"","custom9":"","custom10":"","flagColor":"","flagText":"","statusCode":0,"lang":"","referer":"pacartagena2","refererEditable":"pacartagena2","reference":"","channel":"direct","apiSourceId":0,"apiSource":"Direct","apiReference":"","allowChannelUpdate":"all","allowAutoAction":"enable","allowReview":"default","allowCancellation":{"type":"propertyDefault"},"invoiceeId":null,"bookingTime":"2025-08-06T01:05:56Z","modifiedTime":"2025-08-16T03:28:11Z","cancelTime":null,"price":0,"deposit":0,"tax":0,"commission":0,"rateDescription":"Oferta 1,","stripeToken":null,"apiMessage":""},"infoItems":[],"invoiceItems":[{"id":130329034,"bookingId":73842286,"type":"charge","subType":2,"description":"Cargo Registro / Aseo","status":"","qty":1,"amount":60000,"lineTotal":60000,"vatRate":0,"invoiceeId":null,"createdBy":94918,"createTime":"2025-08-06T01:05:56Z"}],"messages":[],"retries":0}}
INFO: Webhook job queued bookingId=73842286 action=MODIFY jobId=beds24-sync-73842286 {"jobId":"beds24-sync-73842286","bookingId":73842286,"action":"MODIFY"}
INFO: Beds24 webhook job queued bookingId=73842286 action=MODIFY jobId=beds24-sync-73842286 {"jobId":"beds24-sync-73842286","bookingId":73842286,"action":"MODIFY"}
INFO: Beds24 webhook received bookingId=73842286 action=MODIFY {"type":"beds24:webhook","bookingId":73842286,"action":"MODIFY","payload":{"timeStamp":"2025-08-16T03:28:27Z","booking":{"id":73842286,"masterId":null,"bookingGroup":null,"propertyId":173309,"roomId":378318,"unitId":1,"roomQty":1,"offerId":1,"status":"confirmed","subStatus":"none","arrival":"2025-08-26","departure":"2025-09-02","numAdult":2,"numChild":0,"title":"STIVEN COLEGA","firstName":"","lastName":"","email":"","phone":"","mobile":"","fax":"","company":"","address":"","city":"","state":"","postcode":"","country":"","country2":null,"arrivalTime":"","voucher":"","comments":"","notes":"Transferred from Apartamento 715 para Aparta Estudio 1722-B at 22:28 - 15 Aug 2025\nTransferred from Aparta Estudio 1722-B para Apartamento 715 at 22:28 - 15 Aug 2025","message":"","groupNote":"","custom1":"","custom2":"","custom3":"","custom4":"","custom5":"","custom6":"","custom7":"","custom8":"","custom9":"","custom10":"","flagColor":"","flagText":"","statusCode":0,"lang":"","referer":"pacartagena2","refererEditable":"pacartagena2","reference":"","channel":"direct","apiSourceId":0,"apiSource":"Direct","apiReference":"","allowChannelUpdate":"all","allowAutoAction":"enable","allowReview":"default","allowCancellation":{"type":"propertyDefault"},"invoiceeId":null,"bookingTime":"2025-08-06T01:05:56Z","modifiedTime":"2025-08-16T03:28:25Z","cancelTime":null,"price":0,"deposit":0,"tax":0,"commission":0,"rateDescription":"Oferta 1,","stripeToken":null,"apiMessage":""},"infoItems":[],"invoiceItems":[{"id":130329034,"bookingId":73842286,"type":"charge","subType":2,"description":"Cargo Registro / Aseo","status":"","qty":1,"amount":60000,"lineTotal":60000,"vatRate":0,"invoiceeId":null,"createdBy":94918,"createTime":"2025-08-06T01:05:56Z"}],"messages":[],"retries":0}}
INFO: Webhook job queued bookingId=73842286 action=MODIFY jobId=beds24-sync-73842286 {"jobId":"beds24-sync-73842286","bookingId":73842286,"action":"MODIFY"}
INFO: Beds24 webhook job queued bookingId=73842286 action=MODIFY jobId=beds24-sync-73842286 {"jobId":"beds24-sync-73842286","bookingId":73842286,"action":"MODIFY"}
INFO: Beds24 webhook received bookingId=74321670 action=MODIFY {"type":"beds24:webhook","bookingId":74321670,"action":"MODIFY","payload":{"timeStamp":"2025-08-16T03:30:23Z","booking":{"id":74321670,"masterId":null,"bookingGroup":null,"propertyId":240061,"roomId":506591,"unitId":1,"roomQty":1,"offerId":1,"status":"confirmed","subStatus":"none","arrival":"2025-08-25","departure":"2025-08-27","numAdult":2,"numChild":0,"title":"","firstName":"NUEVA CREADA","lastName":"","email":"","phone":"","mobile":"","fax":"","company":"","address":"","city":"","state":"","postcode":"","country":"","country2":null,"arrivalTime":"","voucher":"","comments":"","notes":"","message":"","groupNote":"","custom1":"","custom2":"","custom3":"","custom4":"","custom5":"","custom6":"","custom7":"","custom8":"","custom9":"","custom10":"","flagColor":"","flagText":"","statusCode":0,"lang":"","referer":"pacartagena2","refererEditable":"pacartagena2","reference":"","channel":"direct","apiSourceId":0,"apiSource":"Direct","apiReference":"","allowChannelUpdate":"all","allowAutoAction":"enable","allowReview":"default","allowCancellation":{"type":"propertyDefault"},"invoiceeId":null,"bookingTime":"2025-08-16T03:30:19Z","modifiedTime":"2025-08-16T03:30:19Z","cancelTime":null,"price":70000,"deposit":0,"tax":0,"commission":0,"rateDescription":"Oferta 1,","stripeToken":null,"apiMessage":""},"infoItems":[],"invoiceItems":[{"id":131340933,"bookingId":74321670,"type":"charge","subType":2,"description":"Cargo Registro / Aseo","status":"","qty":1,"amount":70000,"lineTotal":70000,"vatRate":0,"invoiceeId":null,"createdBy":94918,"createTime":"2025-08-16T03:30:19Z"}],"messages":[],"retries":0}}
INFO: Webhook job queued bookingId=74321670 action=MODIFY jobId=beds24-sync-74321670 {"jobId":"beds24-sync-74321670","bookingId":74321670,"action":"MODIFY"}
INFO: Beds24 webhook job queued bookingId=74321670 action=MODIFY jobId=beds24-sync-74321670 {"jobId":"beds24-sync-74321670","bookingId":74321670,"action":"MODIFY"}
INFO: Beds24 webhook received bookingId=74321670 action=MODIFY {"type":"beds24:webhook","bookingId":74321670,"action":"MODIFY","payload":{"timeStamp":"2025-08-16T03:30:34Z","booking":{"id":74321670,"masterId":null,"bookingGroup":null,"propertyId":240061,"roomId":506591,"unitId":1,"roomQty":1,"offerId":1,"status":"confirmed","subStatus":"none","arrival":"2025-08-25","departure":"2025-08-27","numAdult":2,"numChild":0,"title":"","firstName":"NUEVA CREADA - LUEGO CANCELADA","lastName":"","email":"","phone":"","mobile":"","fax":"","company":"","address":"","city":"","state":"","postcode":"","country":"","country2":null,"arrivalTime":"","voucher":"","comments":"","notes":"","message":"","groupNote":"","custom1":"","custom2":"","custom3":"","custom4":"","custom5":"","custom6":"","custom7":"","custom8":"","custom9":"","custom10":"","flagColor":"","flagText":"","statusCode":0,"lang":"","referer":"pacartagena2","refererEditable":"pacartagena2","reference":"","channel":"direct","apiSourceId":0,"apiSource":"Direct","apiReference":"","allowChannelUpdate":"all","allowAutoAction":"enable","allowReview":"default","allowCancellation":{"type":"propertyDefault"},"invoiceeId":null,"bookingTime":"2025-08-16T03:30:19Z","modifiedTime":"2025-08-16T03:30:29Z","cancelTime":null,"price":70000,"deposit":0,"tax":0,"commission":0,"rateDescription":"Oferta 1,","stripeToken":null,"apiMessage":""},"infoItems":[],"invoiceItems":[{"id":131340933,"bookingId":74321670,"type":"charge","subType":2,"description":"Cargo Registro / Aseo","status":"","qty":1,"amount":70000,"lineTotal":70000,"vatRate":0,"invoiceeId":null,"createdBy":94918,"createTime":"2025-08-16T03:30:19Z"}],"messages":[],"retries":0}}
INFO: Webhook job queued bookingId=74321670 action=MODIFY jobId=beds24-sync-74321670 {"jobId":"beds24-sync-74321670","bookingId":74321670,"action":"MODIFY"}
INFO: Beds24 webhook job queued bookingId=74321670 action=MODIFY jobId=beds24-sync-74321670 {"jobId":"beds24-sync-74321670","bookingId":74321670,"action":"MODIFY"}
INFO: Beds24 webhook received bookingId=74321670 action=MODIFY {"type":"beds24:webhook","bookingId":74321670,"action":"MODIFY","payload":{"timeStamp":"2025-08-16T03:30:39Z","booking":{"id":74321670,"masterId":null,"bookingGroup":null,"propertyId":240061,"roomId":506591,"unitId":1,"roomQty":1,"offerId":1,"status":"cancelled","subStatus":"none","arrival":"2025-08-25","departure":"2025-08-27","numAdult":2,"numChild":0,"title":"","firstName":"NUEVA CREADA - LUEGO CANCELADA","lastName":"","email":"","phone":"","mobile":"","fax":"","company":"","address":"","city":"","state":"","postcode":"","country":"","country2":null,"arrivalTime":"","voucher":"","comments":"","notes":"","message":"","groupNote":"","custom1":"","custom2":"","custom3":"","custom4":"","custom5":"","custom6":"","custom7":"","custom8":"","custom9":"","custom10":"","flagColor":"","flagText":"","statusCode":0,"lang":"","referer":"pacartagena2","refererEditable":"pacartagena2","reference":"","channel":"direct","apiSourceId":0,"apiSource":"Direct","apiReference":"","allowChannelUpdate":"all","allowAutoAction":"enable","allowReview":"default","allowCancellation":{"type":"propertyDefault"},"invoiceeId":null,"bookingTime":"2025-08-16T03:30:19Z","modifiedTime":"2025-08-16T03:30:35Z","cancelTime":"2025-08-16T03:30:35Z","price":70000,"deposit":0,"tax":0,"commission":0,"rateDescription":"Oferta 1,","stripeToken":null,"apiMessage":""},"infoItems":[],"invoiceItems":[{"id":131340933,"bookingId":74321670,"type":"charge","subType":2,"description":"Cargo Registro / Aseo","status":"","qty":1,"amount":70000,"lineTotal":70000,"vatRate":0,"invoiceeId":null,"createdBy":94918,"createTime":"2025-08-16T03:30:19Z"}],"messages":[],"retries":0}}
INFO: Webhook job queued bookingId=74321670 action=MODIFY jobId=beds24-sync-74321670 {"jobId":"beds24-sync-74321670","bookingId":74321670,"action":"MODIFY"}
INFO: Beds24 webhook job queued bookingId=74321670 action=MODIFY jobId=beds24-sync-74321670 {"jobId":"beds24-sync-74321670","bookingId":74321670,"action":"MODIFY"}
INFO: Beds24 webhook received bookingId=70836255 action=MODIFY {"type":"beds24:webhook","bookingId":70836255,"action":"MODIFY","payload":{"timeStamp":"2025-08-16T03:36:02Z","booking":{"id":70836255,"masterId":null,"bookingGroup":null,"propertyId":173207,"roomId":378110,"unitId":1,"roomQty":1,"offerId":0,"status":"confirmed","subStatus":"none","arrival":"2025-08-15","departure":"2025-08-19","numAdult":2,"numChild":0,"title":"","firstName":"Jeremy","lastName":"Quesada","email":"jquesa.595235@guest.booking.com","phone":"+506 8562 7688","mobile":"","fax":"","company":"","address":"","city":".","state":"","postcode":"","country":"cr","country2":"CR","arrivalTime":"","voucher":"","comments":"Non Smoking Requested","notes":"","message":"","groupNote":"","custom1":"","custom2":"","custom3":"","custom4":"","custom5":"","custom6":"","custom7":"","custom8":"","custom9":"","custom10":"","flagColor":"","flagText":"","statusCode":0,"lang":"","referer":"Booking.com","refererEditable":"Booking.com","reference":"","channel":"booking","apiSourceId":19,"apiSource":"Booking.com","apiReference":"5461224375","allowChannelUpdate":"all","allowAutoAction":"enable","allowReview":"default","allowCancellation":{"type":"propertyDefault"},"invoiceeId":null,"bookingTime":"2025-06-02T23:17:31Z","modifiedTime":"2025-08-16T03:36:00Z","cancelTime":null,"price":1054000,"deposit":0,"tax":0,"commission":158100,"rateDescription":"2025-08-15 (54299928 Standard Rate) COP 205000\n2025-08-16 (54299928 Standard Rate) COP 205000\n2025-08-17 (54299928 Standard Rate) COP 205000\n2025-08-18 (54299928 Standard Rate) COP 205000\nTotal Commission: 158100\nCard: Visa\n","stripeToken":null,"apiMessage":"Room: Apartamento de 1 dormitorio con balcÃ³n y vistas al mar\nBoasting 1 bedroom and 1 bathroom, this apartment has a living room and private pool where you can relax. The apartment's kitchen is available for cooking and storing food. This apartment features air conditioning, a flat-screen TV and a balcony. The unit offers 5 beds.\n\nEl precio de esta habitaciÃ³n no incluye servicio de comidas. Condiciones referentes a niÃ±os y camas supletorias: Se permiten niÃ±os de cualquier edad. No has aÃ±adido ninguna cuna. No has aÃ±adido ninguna cama supletoria. El nÃºmero mÃ¡ximo de personas es 6.  Condiciones sobre depÃ³sitos: El cliente tendrÃ¡ que pagar por adelantado el precio de la primera noche despuÃ©s de hacer la reserva.  Condiciones de cancelaciÃ³n: El cliente puede cancelar la reserva de forma gratuita hasta 7 dÃ­as antes de la fecha de llegada. El cliente tendrÃ¡ que pagar el precio de la primera noche si cancela durante los 7 dÃ­as antes de la fecha de llegada. Si el cliente no se presenta, tendrÃ¡ que pagar el precio total de la reserva.\n\nMeal Plan: El precio de esta habitaciÃ³n no incluye servicio de comidas.\n\nRoom Rservation Id: 5598347339"},"infoItems":[],"invoiceItems":[{"id":123978381,"bookingId":70836255,"type":"charge","subType":8,"description":"[ROOMNAME1] [FIRSTNIGHT] - [LEAVINGDAY]","status":"","qty":1,"amount":820000,"lineTotal":820000,"vatRate":0,"invoiceeId":null,"createdBy":null,"createTime":"2025-06-02T23:17:31Z"},{"id":123978382,"bookingId":70836255,"type":"charge","subType":11,"description":"cargo por servicio","status":"","qty":1,"amount":164000,"lineTotal":164000,"vatRate":0,"invoiceeId":null,"createdBy":null,"createTime":"2025-06-02T23:17:31Z"},{"id":123978383,"bookingId":70836255,"type":"charge","subType":11,"description":"suplemento de limpieza","status":"","qty":1,"amount":70000,"lineTotal":70000,"vatRate":0,"invoiceeId":null,"createdBy":null,"createTime":"2025-06-02T23:17:31Z"},{"id":131341118,"bookingId":70836255,"type":"payment","subType":200,"description":"","status":"","amount":150000,"lineTotal":-150000,"invoiceeId":null,"createdBy":94918,"createTime":"2025-08-16T03:36:00Z"}],"messages":[],"retries":0}}
INFO: Webhook job queued bookingId=70836255 action=MODIFY jobId=beds24-sync-70836255 {"jobId":"beds24-sync-70836255","bookingId":70836255,"action":"MODIFY"}
INFO: Beds24 webhook job queued bookingId=70836255 action=MODIFY jobId=beds24-sync-70836255 {"jobId":"beds24-sync-70836255","bookingId":70836255,"action":"MODIFY"}
