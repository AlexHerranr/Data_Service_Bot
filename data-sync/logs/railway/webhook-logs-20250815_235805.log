
=============================
üîó Railway Webhook Logs - 16/8/2025, 12:02:45 a.¬†m.
=============================
Filtrado desde: railway-logs-complete-20250815_235805.log
L√≠neas de webhook: 38
T√©rminos: webhook, beds24, Processing Beds24 webhook
=============================

INFO: Processing job jobId=beds24-sync-74321984 {"jobId":"beds24-sync-74321984","type":"beds24-webhook","attempt":1,"maxAttempts":3}
INFO: Processing Beds24 webhook bookingId=74321984 action=MODIFY jobId=beds24-sync-74321984 {"jobId":"beds24-sync-74321984","bookingId":74321984,"action":"MODIFY","webhookType":"beds24-webhook"}
INFO: Starting syncSingleBooking call bookingId=74321984 action=MODIFY jobId=beds24-sync-74321984 {"jobId":"beds24-sync-74321984","bookingId":74321984,"action":"MODIFY"}
INFO: Processing job jobId=beds24-sync-74321990 {"jobId":"beds24-sync-74321990","type":"beds24-webhook","attempt":1,"maxAttempts":3}
INFO: Processing Beds24 webhook bookingId=74321990 action=MODIFY jobId=beds24-sync-74321990 {"jobId":"beds24-sync-74321990","bookingId":74321990,"action":"MODIFY","webhookType":"beds24-webhook"}
INFO: Starting syncSingleBooking call bookingId=74321990 action=MODIFY jobId=beds24-sync-74321990 {"jobId":"beds24-sync-74321990","bookingId":74321990,"action":"MODIFY"}
ERROR: ‚ùå Failed to sync to BD - check constraints and data bookingId=74321990 {"stack":"PrismaClientKnownRequestError: \nInvalid `prisma.booking.upsert()` invocation:\n\n\nNull constraint violation on the fields: (`leadType`)\n    at ei.handleRequestError (/app/data-sync/node_modules/.prisma/client/runtime/library.js:124:7283)\n    at ei.handleAndLogRequestError (/app/data-sync/node_modules/.prisma/client/runtime/library.js:124:6608)\n    at ei.request (/app/data-sync/node_modules/.prisma/client/runtime/library.js:124:6315)\n    at async a (/app/data-sync/node_modules/.prisma/client/runtime/library.js:133:9551)\n    at async processSingleBookingData (file:///app/data-sync/dist/providers/beds24/sync.js:76:24)\n    at async syncSingleBooking (file:///app/data-sync/dist/providers/beds24/sync.js:19:16)\n    at async Worker.connection [as processFn] (file:///app/data-sync/dist/infra/queues/queue.manager.js:45:36)\n    at async /app/data-sync/node_modules/bullmq/dist/cjs/classes/worker.js:496:32\n    at async Worker.retryIfFailed (/app/data-sync/node_modules/bullmq/dist/cjs/classes/worker.js:774:24)","bookingId":74321990,"data":{"id":74321990,"masterId":null,"propertyId":173308,"roomId":378317,"unitId":1,"roomQty":1,"offerId":1,"status":"confirmed","subStatus":"none","arrival":"2025-08-26","departure":"2025-08-28","numAdult":2,"numChild":0,"title":"RESERVA NUEVA 2","firstName":"CAMBIO","lastName":"","email":"","phone":"","mobile":"","fax":"","company":"","address":"","city":"","state":"","postcode":"","country":"","country2":null,"arrivalTime":"","voucher":"","comments":"","notes":"","message":"","groupNote":"","custom1":"","custom2":"","custom3":"","custom4":"","custom5":"","custom6":"","custom7":"","custom8":"","custom9":"","custom10":"","flagColor":"","flagText":"","statusCode":0,"lang":"","referer":"pacartagena2","refererEditable":"pacartagena2","reference":"","channel":"direct","apiSourceId":0,"apiSource":"Direct","apiReference":"","allowChannelUpdate":"all","allowAutoAction":"enable","allowReview":"default","allowCancellation":{"type":"propertyDefault"},"invoiceeId":null,"bookingTime":"2025-08-16T03:48:25Z","modifiedTime":"2025-08-16T03:48:55Z","cancelTime":null,"infoItems":[],"price":0,"deposit":0,"tax":0,"commission":0,"rateDescription":"Oferta 1,","stripeToken":null,"apiMessage":""},"constraint":"P2011"}
INFO: ‚úÖ syncSingleBooking completed bookingId=74321990 action=skipped jobId=beds24-sync-74321990 {"jobId":"beds24-sync-74321990","bookingId":74321990,"syncResult":{"success":false,"action":"skipped","table":"Booking"},"success":false,"action":"skipped","table":"Booking"}
ERROR: ‚ùå Job processing failed at sync bookingId=74321990 action=MODIFY jobId=beds24-sync-74321990 {"jobId":"beds24-sync-74321990","stack":"Error: Sync failed: skipped - Booking\n    at Worker.connection [as processFn] (file:///app/data-sync/dist/infra/queues/queue.manager.js:55:27)\n    at async /app/data-sync/node_modules/bullmq/dist/cjs/classes/worker.js:496:32\n    at async Worker.retryIfFailed (/app/data-sync/node_modules/bullmq/dist/cjs/classes/worker.js:774:24)","step":"sync_phase","bookingId":74321990,"action":"MODIFY","duration":523}
WARN: Job failed, will retry jobId=beds24-sync-74321990 {"jobId":"beds24-sync-74321990","attempt":1}
INFO: Processing job jobId=beds24-sync-74321670 {"jobId":"beds24-sync-74321670","type":"beds24-webhook","attempt":3,"maxAttempts":3}
INFO: Processing Beds24 webhook bookingId=74321670 action=MODIFY jobId=beds24-sync-74321670 {"jobId":"beds24-sync-74321670","bookingId":74321670,"action":"MODIFY","webhookType":"beds24-webhook"}
INFO: Starting syncSingleBooking call bookingId=74321670 action=MODIFY jobId=beds24-sync-74321670 {"jobId":"beds24-sync-74321670","bookingId":74321670,"action":"MODIFY"}
ERROR: ‚ùå Failed to sync to BD - check constraints and data bookingId=74321984 {"stack":"PrismaClientKnownRequestError: \nInvalid `prisma.booking.upsert()` invocation:\n\n\nNull constraint violation on the fields: (`leadType`)\n    at ei.handleRequestError (/app/data-sync/node_modules/.prisma/client/runtime/library.js:124:7283)\n    at ei.handleAndLogRequestError (/app/data-sync/node_modules/.prisma/client/runtime/library.js:124:6608)\n    at ei.request (/app/data-sync/node_modules/.prisma/client/runtime/library.js:124:6315)\n    at async a (/app/data-sync/node_modules/.prisma/client/runtime/library.js:133:9551)\n    at async processSingleBookingData (file:///app/data-sync/dist/providers/beds24/sync.js:76:24)\n    at async syncSingleBooking (file:///app/data-sync/dist/providers/beds24/sync.js:19:16)\n    at async Worker.connection [as processFn] (file:///app/data-sync/dist/infra/queues/queue.manager.js:45:36)\n    at async /app/data-sync/node_modules/bullmq/dist/cjs/classes/worker.js:496:32\n    at async Worker.retryIfFailed (/app/data-sync/node_modules/bullmq/dist/cjs/classes/worker.js:774:24)","bookingId":74321984,"data":{"id":74321984,"masterId":null,"propertyId":240061,"roomId":506591,"unitId":1,"roomQty":1,"offerId":1,"status":"confirmed","subStatus":"none","arrival":"2025-08-26","departure":"2025-08-28","numAdult":5,"numChild":0,"title":"RESERVA NUEVA","firstName":"","lastName":"","email":"","phone":"","mobile":"","fax":"","company":"","address":"","city":"","state":"","postcode":"","country":"","country2":null,"arrivalTime":"","voucher":"","comments":"","notes":"","message":"","groupNote":"","custom1":"","custom2":"","custom3":"","custom4":"","custom5":"","custom6":"","custom7":"","custom8":"","custom9":"","custom10":"","flagColor":"","flagText":"","statusCode":0,"lang":"","referer":"pacartagena2","refererEditable":"pacartagena2","reference":"","channel":"direct","apiSourceId":0,"apiSource":"Direct","apiReference":"","allowChannelUpdate":"all","allowAutoAction":"enable","allowReview":"default","allowCancellation":{"type":"propertyDefault"},"invoiceeId":null,"bookingTime":"2025-08-16T03:48:10Z","modifiedTime":"2025-08-16T03:48:41Z","cancelTime":null,"infoItems":[],"price":70000,"deposit":0,"tax":0,"commission":0,"rateDescription":"Oferta 1,","stripeToken":null,"apiMessage":""},"constraint":"P2011"}
INFO: ‚úÖ syncSingleBooking completed bookingId=74321984 action=skipped jobId=beds24-sync-74321984 {"jobId":"beds24-sync-74321984","bookingId":74321984,"syncResult":{"success":false,"action":"skipped","table":"Booking"},"success":false,"action":"skipped","table":"Booking"}
ERROR: ‚ùå Job processing failed at sync bookingId=74321984 action=MODIFY jobId=beds24-sync-74321984 {"jobId":"beds24-sync-74321984","stack":"Error: Sync failed: skipped - Booking\n    at Worker.connection [as processFn] (file:///app/data-sync/dist/infra/queues/queue.manager.js:55:27)\n    at async /app/data-sync/node_modules/bullmq/dist/cjs/classes/worker.js:496:32\n    at async Worker.retryIfFailed (/app/data-sync/node_modules/bullmq/dist/cjs/classes/worker.js:774:24)","step":"sync_phase","bookingId":74321984,"action":"MODIFY","duration":577}
WARN: Job failed, will retry jobId=beds24-sync-74321984 {"jobId":"beds24-sync-74321984","attempt":1}
INFO: Processing job jobId=beds24-sync-70836255 {"jobId":"beds24-sync-70836255","type":"beds24-webhook","attempt":3,"maxAttempts":3}
INFO: Processing Beds24 webhook bookingId=70836255 action=MODIFY jobId=beds24-sync-70836255 {"jobId":"beds24-sync-70836255","bookingId":70836255,"action":"MODIFY","webhookType":"beds24-webhook"}
INFO: Starting syncSingleBooking call bookingId=70836255 action=MODIFY jobId=beds24-sync-70836255 {"jobId":"beds24-sync-70836255","bookingId":70836255,"action":"MODIFY"}
INFO: ‚úÖ syncSingleBooking completed bookingId=70836255 action=updated jobId=beds24-sync-70836255 {"jobId":"beds24-sync-70836255","bookingId":70836255,"syncResult":{"success":true,"action":"updated","table":"Booking"},"success":true,"action":"updated","table":"Booking"}
INFO: Beds24 webhook job completed bookingId=70836255 action=MODIFY jobId=beds24-sync-70836255 {"jobId":"beds24-sync-70836255","bookingId":70836255,"action":"MODIFY","duration":390}
INFO: ‚úÖ syncSingleBooking completed bookingId=74321670 action=created jobId=beds24-sync-74321670 {"jobId":"beds24-sync-74321670","bookingId":74321670,"syncResult":{"success":true,"action":"created","table":"Booking"},"success":true,"action":"created","table":"Booking"}
INFO: Beds24 webhook job completed bookingId=74321670 action=MODIFY jobId=beds24-sync-74321670 {"jobId":"beds24-sync-74321670","bookingId":74321670,"action":"MODIFY","duration":494}
INFO: Processing job jobId=beds24-sync-74321990 {"jobId":"beds24-sync-74321990","type":"beds24-webhook","attempt":2,"maxAttempts":3}
INFO: Processing Beds24 webhook bookingId=74321990 action=MODIFY jobId=beds24-sync-74321990 {"jobId":"beds24-sync-74321990","bookingId":74321990,"action":"MODIFY","webhookType":"beds24-webhook"}
INFO: Starting syncSingleBooking call bookingId=74321990 action=MODIFY jobId=beds24-sync-74321990 {"jobId":"beds24-sync-74321990","bookingId":74321990,"action":"MODIFY"}
INFO: Processing job jobId=beds24-sync-74321984 {"jobId":"beds24-sync-74321984","type":"beds24-webhook","attempt":2,"maxAttempts":3}
INFO: Processing Beds24 webhook bookingId=74321984 action=MODIFY jobId=beds24-sync-74321984 {"jobId":"beds24-sync-74321984","bookingId":74321984,"action":"MODIFY","webhookType":"beds24-webhook"}
INFO: Starting syncSingleBooking call bookingId=74321984 action=MODIFY jobId=beds24-sync-74321984 {"jobId":"beds24-sync-74321984","bookingId":74321984,"action":"MODIFY"}
ERROR: ‚ùå Failed to sync to BD - check constraints and data bookingId=74321990 {"stack":"PrismaClientKnownRequestError: \nInvalid `prisma.booking.upsert()` invocation:\n\n\nNull constraint violation on the fields: (`leadType`)\n    at ei.handleRequestError (/app/data-sync/node_modules/.prisma/client/runtime/library.js:124:7283)\n    at ei.handleAndLogRequestError (/app/data-sync/node_modules/.prisma/client/runtime/library.js:124:6608)\n    at ei.request (/app/data-sync/node_modules/.prisma/client/runtime/library.js:124:6315)\n    at async a (/app/data-sync/node_modules/.prisma/client/runtime/library.js:133:9551)\n    at async processSingleBookingData (file:///app/data-sync/dist/providers/beds24/sync.js:76:24)\n    at async syncSingleBooking (file:///app/data-sync/dist/providers/beds24/sync.js:19:16)\n    at async Worker.connection [as processFn] (file:///app/data-sync/dist/infra/queues/queue.manager.js:45:36)\n    at async /app/data-sync/node_modules/bullmq/dist/cjs/classes/worker.js:496:32\n    at async Worker.retryIfFailed (/app/data-sync/node_modules/bullmq/dist/cjs/classes/worker.js:774:24)","bookingId":74321990,"data":{"id":74321990,"masterId":null,"propertyId":173308,"roomId":378317,"unitId":1,"roomQty":1,"offerId":1,"status":"confirmed","subStatus":"none","arrival":"2025-08-26","departure":"2025-08-28","numAdult":2,"numChild":0,"title":"RESERVA NUEVA 2","firstName":"CAMBIO","lastName":"","email":"","phone":"","mobile":"","fax":"","company":"","address":"","city":"","state":"","postcode":"","country":"","country2":null,"arrivalTime":"","voucher":"","comments":"","notes":"","message":"","groupNote":"","custom1":"","custom2":"","custom3":"","custom4":"","custom5":"","custom6":"","custom7":"","custom8":"","custom9":"","custom10":"","flagColor":"","flagText":"","statusCode":0,"lang":"","referer":"pacartagena2","refererEditable":"pacartagena2","reference":"","channel":"direct","apiSourceId":0,"apiSource":"Direct","apiReference":"","allowChannelUpdate":"all","allowAutoAction":"enable","allowReview":"default","allowCancellation":{"type":"propertyDefault"},"invoiceeId":null,"bookingTime":"2025-08-16T03:48:25Z","modifiedTime":"2025-08-16T03:48:55Z","cancelTime":null,"infoItems":[],"price":0,"deposit":0,"tax":0,"commission":0,"rateDescription":"Oferta 1,","stripeToken":null,"apiMessage":""},"constraint":"P2011"}
INFO: ‚úÖ syncSingleBooking completed bookingId=74321990 action=skipped jobId=beds24-sync-74321990 {"jobId":"beds24-sync-74321990","bookingId":74321990,"syncResult":{"success":false,"action":"skipped","table":"Booking"},"success":false,"action":"skipped","table":"Booking"}
ERROR: ‚ùå Job processing failed at sync bookingId=74321990 action=MODIFY jobId=beds24-sync-74321990 {"jobId":"beds24-sync-74321990","stack":"Error: Sync failed: skipped - Booking\n    at Worker.connection [as processFn] (file:///app/data-sync/dist/infra/queues/queue.manager.js:55:27)\n    at async /app/data-sync/node_modules/bullmq/dist/cjs/classes/worker.js:496:32\n    at async Worker.retryIfFailed (/app/data-sync/node_modules/bullmq/dist/cjs/classes/worker.js:774:24)","step":"sync_phase","bookingId":74321990,"action":"MODIFY","duration":377}
WARN: Job failed, will retry jobId=beds24-sync-74321990 {"jobId":"beds24-sync-74321990","attempt":2}
ERROR: ‚ùå Failed to sync to BD - check constraints and data bookingId=74321984 {"stack":"PrismaClientKnownRequestError: \nInvalid `prisma.booking.upsert()` invocation:\n\n\nNull constraint violation on the fields: (`leadType`)\n    at ei.handleRequestError (/app/data-sync/node_modules/.prisma/client/runtime/library.js:124:7283)\n    at ei.handleAndLogRequestError (/app/data-sync/node_modules/.prisma/client/runtime/library.js:124:6608)\n    at ei.request (/app/data-sync/node_modules/.prisma/client/runtime/library.js:124:6315)\n    at async a (/app/data-sync/node_modules/.prisma/client/runtime/library.js:133:9551)\n    at async processSingleBookingData (file:///app/data-sync/dist/providers/beds24/sync.js:76:24)\n    at async syncSingleBooking (file:///app/data-sync/dist/providers/beds24/sync.js:19:16)\n    at async Worker.connection [as processFn] (file:///app/data-sync/dist/infra/queues/queue.manager.js:45:36)\n    at async /app/data-sync/node_modules/bullmq/dist/cjs/classes/worker.js:496:32\n    at async Worker.retryIfFailed (/app/data-sync/node_modules/bullmq/dist/cjs/classes/worker.js:774:24)","bookingId":74321984,"data":{"id":74321984,"masterId":null,"propertyId":240061,"roomId":506591,"unitId":1,"roomQty":1,"offerId":1,"status":"confirmed","subStatus":"none","arrival":"2025-08-26","departure":"2025-08-28","numAdult":5,"numChild":0,"title":"RESERVA NUEVA","firstName":"","lastName":"","email":"","phone":"","mobile":"","fax":"","company":"","address":"","city":"","state":"","postcode":"","country":"","country2":null,"arrivalTime":"","voucher":"","comments":"","notes":"","message":"","groupNote":"","custom1":"","custom2":"","custom3":"","custom4":"","custom5":"","custom6":"","custom7":"","custom8":"","custom9":"","custom10":"","flagColor":"","flagText":"","statusCode":0,"lang":"","referer":"pacartagena2","refererEditable":"pacartagena2","reference":"","channel":"direct","apiSourceId":0,"apiSource":"Direct","apiReference":"","allowChannelUpdate":"all","allowAutoAction":"enable","allowReview":"default","allowCancellation":{"type":"propertyDefault"},"invoiceeId":null,"bookingTime":"2025-08-16T03:48:10Z","modifiedTime":"2025-08-16T03:48:41Z","cancelTime":null,"infoItems":[],"price":70000,"deposit":0,"tax":0,"commission":0,"rateDescription":"Oferta 1,","stripeToken":null,"apiMessage":""},"constraint":"P2011"}
INFO: ‚úÖ syncSingleBooking completed bookingId=74321984 action=skipped jobId=beds24-sync-74321984 {"jobId":"beds24-sync-74321984","bookingId":74321984,"syncResult":{"success":false,"action":"skipped","table":"Booking"},"success":false,"action":"skipped","table":"Booking"}
ERROR: ‚ùå Job processing failed at sync bookingId=74321984 action=MODIFY jobId=beds24-sync-74321984 {"jobId":"beds24-sync-74321984","stack":"Error: Sync failed: skipped - Booking\n    at Worker.connection [as processFn] (file:///app/data-sync/dist/infra/queues/queue.manager.js:55:27)\n    at async /app/data-sync/node_modules/bullmq/dist/cjs/classes/worker.js:496:32\n    at async Worker.retryIfFailed (/app/data-sync/node_modules/bullmq/dist/cjs/classes/worker.js:774:24)","step":"sync_phase","bookingId":74321984,"action":"MODIFY","duration":418}
WARN: Job failed, will retry jobId=beds24-sync-74321984 {"jobId":"beds24-sync-74321984","attempt":2}